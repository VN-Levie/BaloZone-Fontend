# BaloZone Backend API Documentation

## üìä Th·ªëng k√™ d·ªØ li·ªáu ƒë√£ t·∫°o
- **Users**: 22 (bao g·ªìm admin v√† test users)
- **Categories**: 6 (Balo H·ªçc Sinh, Balo Du L·ªãch, Balo Laptop, etc.)
- **Brands**: 16 (Nike, Adidas, Samsonite, JanSport, The North Face, Herschel + 10 random)
- **Products**: 55 (bao g·ªìm s·∫£n ph·∫©m c·ª• th·ªÉ v√† random)
- **Orders**: 30 ƒë∆°n h√†ng v·ªõi 72 chi ti·∫øt ƒë∆°n h√†ng
- **Comments**: 100 b√¨nh lu·∫≠n
- **News**: 20 tin t·ª©c
- **Contacts**: 23 li√™n h·ªá
- **Payment Methods**: 6 ph∆∞∆°ng th·ª©c thanh to√°n
- **Vouchers**: 6 voucher khuy·∫øn m√£i
- **Address Books**: 46 ƒë·ªãa ch·ªâ

## üîó API Endpoints

### Authentication
```
POST   /api/auth/login              - User login
POST   /api/auth/register           - User registration
POST   /api/auth/logout             - User logout (protected)
POST   /api/auth/refresh            - Refresh JWT token (protected)
GET    /api/auth/me                 - Get current user info (protected)
```

### User Profile (Protected)
```
GET    /api/profile                 - Get user profile
PUT    /api/profile                 - Update user profile
POST   /api/change-password         - Change password
GET    /api/user-stats              - Get user statistics
DELETE /api/delete-account          - Delete user account
```

### Address Books (Protected)
```
GET    /api/address-books           - Get user addresses
POST   /api/address-books           - Create new address
GET    /api/address-books/{id}      - Get specific address
PUT    /api/address-books/{id}      - Update address
DELETE /api/address-books/{id}      - Delete address
```

### Brands
```
GET    /api/brands                  - List brands (search, filter, pagination)
POST   /api/brands                  - Create brand
GET    /api/brands/{id}             - Get brand details
PUT    /api/brands/{id}             - Update brand
DELETE /api/brands/{id}             - Delete brand
GET    /api/brands-active           - Get active brands for select
```

### Categories
```
GET    /api/categories              - List categories (search, pagination)
POST   /api/categories              - Create category
GET    /api/categories/{id}         - Get category details
PUT    /api/categories/{id}         - Update category
DELETE /api/categories/{id}         - Delete category
GET    /api/categories-with-products - Get categories with products
```

### Products
```
GET    /api/products                - List products (search, filter, sort, pagination)
POST   /api/products                - Create product  
GET    /api/products/{id}           - Get product details with comments
PUT    /api/products/{id}           - Update product
DELETE /api/products/{id}           - Delete product
GET    /api/products-featured       - Get featured products (8 items)
GET    /api/products/category/{slug} - Get products by category slug
GET    /api/products/brand/{slug}   - Get products by brand slug
GET    /api/products-search         - Search products
GET    /api/products-on-sale        - Get products currently on sale
GET    /api/products/{id}/sale-campaigns - Get sale campaigns for product
```

### Orders (Protected)
```
GET    /api/orders                  - Get user orders
POST   /api/orders                  - Create new order
GET    /api/orders/{id}             - Get order details
POST   /api/orders/{id}/cancel      - Cancel order
GET    /api/orders-stats            - Get order statistics
```

### Vouchers
```
GET    /api/vouchers                - List vouchers (admin)
POST   /api/vouchers                - Create voucher (admin)
GET    /api/vouchers/{id}           - Get voucher details (admin)
PUT    /api/vouchers/{id}           - Update voucher (admin)
DELETE /api/vouchers/{id}           - Delete voucher (admin)
POST   /api/vouchers/validate       - Validate voucher code
GET    /api/vouchers-active         - Get active vouchers
```

### Comments
```
GET    /api/comments                - List comments
POST   /api/comments                - Create comment (protected)
GET    /api/comments/{id}           - Get comment details
PUT    /api/comments/{id}           - Update comment (protected)
DELETE /api/comments/{id}           - Delete comment (protected)
GET    /api/comments/product/{id}   - Get product comments
GET    /api/my-comments             - Get user comments (protected)
```

### News
```
GET    /api/news                    - List news articles
GET    /api/news/{id}               - Get news details
GET    /api/news-latest             - Get latest news
```

### Contacts
```
POST   /api/contacts                - Send contact message
GET    /api/contacts                - List contacts (admin)
GET    /api/contacts/{id}           - Get contact details (admin)
```

**Note:** Contact creation requires `fullname` field, not `name`.

### Query Parameters cho Brands
- `search`: T√¨m ki·∫øm theo t√™n brand
- `status`: L·ªçc theo tr·∫°ng th√°i (active/inactive)
- `per_page`: S·ªë l∆∞·ª£ng items per page (default: 15)

## üìã Database Schema

### Brands Table
```sql
- id (primary key)
- name (string, required)
- description (text, nullable)
- slug (string, unique, required)
- logo (string, nullable)
- status (enum: active/inactive, default: active)
- created_at, updated_at
```

### Products Table (ƒë√£ c·∫≠p nh·∫≠t)
```sql
- id (primary key)
- category_id (foreign key to categories)
- brand_id (foreign key to brands, nullable)
- name (string, required)
- description (text, nullable)
- price (decimal, required)
- quantity (integer, default: 0)
- image (string, nullable)
- slug (string, unique, required)
- color (string, nullable)
- created_at, updated_at
```

### Address Books Table
```sql
- id (primary key)
- user_id (foreign key to users)
- name (string, required) - H·ªç v√† t√™n ng∆∞·ªùi nh·∫≠n
- phone (string, required) - S·ªë ƒëi·ªán tho·∫°i ng∆∞·ªùi nh·∫≠n
- address (text, required) - ƒê·ªãa ch·ªâ chi ti·∫øt
- province (string, required) - T·ªânh/Th√†nh ph·ªë
- district (string, required) - Qu·∫≠n/Huy·ªán
- ward (string, required) - Ph∆∞·ªùng/X√£
- is_default (boolean, default: false) - ƒê·ªãa ch·ªâ m·∫∑c ƒë·ªãnh
- created_at, updated_at
```

### Sale Campaigns Table (m·ªõi)
```sql
- id (primary key)
- name (string, required) - T√™n chi·∫øn d·ªãch
- slug (string, unique, required) - URL-friendly name
- description (text, nullable) - M√¥ t·∫£ chi·∫øn d·ªãch
- banner_image (string, nullable) - H√¨nh ·∫£nh banner
- start_date (datetime, required) - Ng√†y b·∫Øt ƒë·∫ßu sale
- end_date (datetime, required) - Ng√†y k·∫øt th√∫c sale
- status (enum: draft/active/expired/cancelled, default: draft)
- is_featured (boolean, default: false) - Chi·∫øn d·ªãch n·ªïi b·∫≠t
- priority (integer, default: 0) - ƒê·ªô ∆∞u ti√™n hi·ªÉn th·ªã
- metadata (json, nullable) - D·ªØ li·ªáu b·ªï sung
- created_at, updated_at
```

### Sale Products Table (m·ªõi)
```sql
- id (primary key)
- sale_campaign_id (foreign key to sale_campaigns)
- product_id (foreign key to products)
- original_price (decimal, required) - Gi√° g·ªëc
- sale_price (decimal, required) - Gi√° sau khi gi·∫£m
- discount_percentage (decimal) - % gi·∫£m gi√°
- discount_amount (decimal) - S·ªë ti·ªÅn gi·∫£m
- discount_type (enum: percentage/fixed_amount)
- start_date (datetime, nullable) - Override ng√†y campaign
- end_date (datetime, nullable) - Override ng√†y campaign
- max_quantity (integer, nullable) - Gi·ªõi h·∫°n s·ªë l∆∞·ª£ng sale
- sold_quantity (integer, default: 0) - ƒê√£ b√°n
- is_active (boolean, default: true)
- created_at, updated_at
```

## ÔøΩ API Examples

### Address Books API

#### Create Address Book
**POST** `/api/address-books`

**Request Body:**
```json
{
  "name": "Nguy·ªÖn VƒÉn An",
  "phone": "0901234567",
  "address": "123 ƒê∆∞·ªùng Nguy·ªÖn Hu·ªá",
  "province": "TP. H·ªì Ch√≠ Minh",
  "district": "Qu·∫≠n 1",
  "ward": "Ph∆∞·ªùng B·∫øn Ngh√©",
  "is_default": true
}
```

**Response:**
```json
{
  "success": true,
  "message": "ƒê·ªãa ch·ªâ ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng",
  "data": {
    "id": 1,
    "user_id": 1,
    "name": "Nguy·ªÖn VƒÉn An",
    "phone": "0901234567",
    "address": "123 ƒê∆∞·ªùng Nguy·ªÖn Hu·ªá",
    "province": "TP. H·ªì Ch√≠ Minh",
    "district": "Qu·∫≠n 1",
    "ward": "Ph∆∞·ªùng B·∫øn Ngh√©",
    "is_default": true,
    "created_at": "2025-06-19T13:20:00.000000Z",
    "updated_at": "2025-06-19T13:20:00.000000Z"
  }
}
```

#### Get User Address Books
**GET** `/api/address-books`

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "user_id": 1,
      "name": "Nguy·ªÖn VƒÉn An",
      "phone": "0901234567",
      "address": "123 ƒê∆∞·ªùng Nguy·ªÖn Hu·ªá",
      "province": "TP. H·ªì Ch√≠ Minh",
      "district": "Qu·∫≠n 1",
      "ward": "Ph∆∞·ªùng B·∫øn Ngh√©",
      "is_default": true,
      "created_at": "2025-06-19T13:20:00.000000Z",
      "updated_at": "2025-06-19T13:20:00.000000Z"
    }
  ],
  "total": 1
}
```

## ÔøΩüë§ Test Accounts

### Admin Account
- **Email**: admin@balozone.com
- **Password**: admin123
- **Role**: Administrator

### Test Account
- **Email**: test@example.com
- **Password**: password
- **Role**: Regular User

### Sample Users
- **Email**: an.nguyen@gmail.com, binh.tran@gmail.com, etc.
- **Password**: password123

## üéØ Sample Data Created

### Categories
1. **Balo H·ªçc Sinh** - D√†nh cho h·ªçc sinh, sinh vi√™n
2. **Balo Du L·ªãch** - Cho c√°c chuy·∫øn du l·ªãch, trekking
3. **Balo Laptop** - Chuy√™n d·ª•ng ƒë·ª±ng laptop
4. **Balo Th·ªÉ Thao** - D√†nh cho ho·∫°t ƒë·ªông th·ªÉ thao
5. **T√∫i X√°ch** - T√∫i x√°ch th·ªùi trang
6. **Balo Mini** - Balo nh·ªè g·ªçn d·∫°o ph·ªë

### Brands
1. **Nike** - Th∆∞∆°ng hi·ªáu th·ªÉ thao h√†ng ƒë·∫ßu
2. **Adidas** - Th∆∞∆°ng hi·ªáu th·ªÉ thao n·ªïi ti·∫øng
3. **Samsonite** - H√†nh l√Ω v√† balo du l·ªãch cao c·∫•p
4. **JanSport** - Balo h·ªçc sinh v√† du l·ªãch
5. **The North Face** - Balo outdoor v√† leo n√∫i
6. **Herschel** - Thi·∫øt k·∫ø vintage v√† hi·ªán ƒë·∫°i
+ 10 brands random kh√°c

### Sample Products
- **Balo JanSport SuperBreak Classic** - 899,000 VND
- **Balo Nike Heritage 2.0** - 1,200,000 VND
- **Balo The North Face Borealis 28L** - 2,500,000 VND
- **Balo Samsonite Guardit 2.0** - 3,200,000 VND
- **Balo Laptop Herschel Pop Quiz** - 1,800,000 VND
+ 50 s·∫£n ph·∫©m random kh√°c

### Payment Methods
1. **COD** - Thanh to√°n khi nh·∫≠n h√†ng
2. **Bank Transfer** - Chuy·ªÉn kho·∫£n ng√¢n h√†ng
3. **MoMo** - V√≠ ƒëi·ªán t·ª≠ MoMo
4. **ZaloPay** - V√≠ ƒëi·ªán t·ª≠ ZaloPay
5. **VNPay** - C·ªïng thanh to√°n VNPay
6. **Credit Card** - Th·∫ª t√≠n d·ª•ng/Ghi n·ª£

### Vouchers
- **WELCOME10** - Gi·∫£m 50,000 VND (100 l∆∞·ª£t)
- **STUDENT15** - Gi·∫£m 75,000 VND (200 l∆∞·ª£t)
- **SUMMER20** - Gi·∫£m 100,000 VND (50 l∆∞·ª£t)
- **NEWUSER** - Gi·∫£m 30,000 VND (500 l∆∞·ª£t)
- **LOYAL25** - Gi·∫£m 150,000 VND (30 l∆∞·ª£t)
- **FLASH50** - Gi·∫£m 200,000 VND (20 l∆∞·ª£t)

## üîÑ Relationships

### Brand ‚Üí Product (One to Many)
```php
// Brand model
public function products()
{
    return $this->hasMany(Product::class);
}

// Product model
public function brand()
{
    return $this->belongsTo(Brand::class);
}
```

### Category ‚Üí Product (One to Many)
```php
// Category model
public function products()
{
    return $this->hasMany(Product::class);
}

// Product model
public function category()
{
    return $this->belongsTo(Category::class);
}
```

## üß™ Testing API

### Test Brand API
```bash
# L·∫•y danh s√°ch brands
curl -X GET "http://localhost:8000/api/brands"

# T√¨m ki·∫øm brand
curl -X GET "http://localhost:8000/api/brands?search=Nike"

# L·ªçc brand active
curl -X GET "http://localhost:8000/api/brands?status=active"

# L·∫•y brands active cho select
curl -X GET "http://localhost:8000/api/brands-active"
```

### Test v·ªõi Postman
1. Import collection t·ª´ file postman (s·∫Ω t·∫°o ri√™ng)
2. Set base URL: `http://localhost:8000/api`
3. Test c√°c endpoint v·ªõi sample data

## üöÄ Getting Started

1. **Ch·∫°y migration v√† seeder**:
   ```bash
   php artisan migrate:fresh --seed
   ```

2. **Start server**:
   ```bash
   php artisan serve
   ```

3. **Test API**:
   - Base URL: `http://localhost:8000/api`
   - Brands endpoint: `http://localhost:8000/api/brands`

## üìù Notes

- T·∫•t c·∫£ seeder ƒë√£ ƒë∆∞·ª£c t·∫°o v·ªõi d·ªØ li·ªáu nh·∫•t qu√°n
- Th·ª© t·ª± ch·∫°y seeder ƒë√£ ƒë∆∞·ª£c t·ªëi ∆∞u ƒë·ªÉ tr√°nh l·ªói foreign key
- D·ªØ li·ªáu m·∫´u ph√π h·ª£p v·ªõi ng√†nh kinh doanh balo/t√∫i x√°ch
- API responses ƒë·ªÅu tr·∫£ v·ªÅ JSON format
- ƒê√£ implement pagination, search, filter c∆° b·∫£n

---

**Created by**: BaloZone Development Team  
**Last Updated**: June 18, 2025
